%{
#include "y.tab.h"  /* Token definitions generated by bison */

%}

%option noyywrap

DIGIT          [0-9]
WHITESPACE     [ \t\n\r]
NEWLINE        [\n\r\;]
IDENTIFIER     [_a-zA-Z][_a-zA-Z0-9]*
/* [ \t\n] */

%%

\/\/.*                   /* ignore comments */
^#.*$                    /* ignore comments */
{WHITESPACE}+            /* ignore whitespace */

map { return MAP; }
material { return MATERIAL; }
entity { return ENTITY; }
action { return ACTION; }
with { return WITH; }
'.' { return MAP_TILE; }
on_touch { return ON_TOUCH; }
on_interact { return ON_INTERACT; }


true                     { return TRUE; }
false                    { return FALSE; }
maybe(\({DIGIT}+\))?     { return MAYBE; }

[+-]?{DIGIT}+            {
    sscanf(yytext, "%d", &yylval.val);
    return INTEGER;
            }
\".*\"                   {
    yylval.str = malloc( yyleng-1 );
    memcpy( yylval.str, yytext+1, yyleng-2 );
    yylval.str[yyleng-1]='\0';
    return STRING;
}
%[^%]*%                 {
    printf("____%s____\n",yytext);
    return MAP_CONTENT;
 }

{IDENTIFIER}             { return IDENTIFIER; }
{IDENTIFIER}(\.{IDENTIFIER})+   { return COMPOUND_IDENTIFIER; }
{NEWLINE}+               {}
.                        { return yytext[0]; }
